(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{107:function(e,t,s){},113:function(e,t,s){},114:function(e,t,s){},116:function(e,t,s){},134:function(e,t,s){},135:function(e,t,s){},136:function(e,t,s){},137:function(e,t,s){},138:function(e,t,s){},139:function(e,t,s){},140:function(e,t,s){},141:function(e,t,s){},142:function(e,t,s){},143:function(e,t,s){},144:function(e,t,s){},145:function(e,t,s){},176:function(e,t,s){"use strict";s.r(t);var a=s(1),c=s.n(a),n=s(94),r=s.n(n),i=(s(107),s(185)),o=s(188),l=s(189),j=s(190),u=s(14),d=s(7),b=s(18),p=s(31),h=function(e,t){switch(t.type){case"LOGIN_START":return{user:null,isFetching:!0,error:!1};case"LOGIN_SUCCESS":return{user:t.payload,isFetching:!1,error:!1};case"LOGIN_FAILURE":return{user:null,isFetching:!1,error:t.payload};case"FOLLOW":return Object(p.a)(Object(p.a)({},e),{},{user:Object(p.a)(Object(p.a)({},e.user),{},{followings:[].concat(Object(b.a)(e.user.followings),[t.payload])})});case"UNFOLLOW":return Object(p.a)(Object(p.a)({},e),{},{user:Object(p.a)(Object(p.a)({},e.user),{},{followings:e.followings.filter((function(e){return e!==t.payload}))})});default:return e}},m=s(0),O={user:null,isFetching:!1,error:!1},x=Object(a.createContext)(O),f=function(e){var t=e.children,s=Object(a.useReducer)(h,O),c=Object(d.a)(s,2),n=c[0],r=c[1];return Object(m.jsx)(x.Provider,{value:{user:n.user,isFetching:n.isFetching,error:n.error,dispatch:r},children:t})};function v(){var e="http://localhost:8800/images/",t=Object(a.useContext)(x).user;return Object(m.jsxs)("div",{className:"topbarContainer",children:[Object(m.jsx)("div",{className:"topbarLeft",children:Object(m.jsx)(u.b,{to:"/",style:{textDecoration:"none"},children:Object(m.jsx)("span",{className:"logo",children:"Facebook"})})}),Object(m.jsx)("div",{className:"topbarCenter",children:Object(m.jsxs)("div",{className:"searchbar",children:[Object(m.jsx)(i.a,{className:"searchIcon"}),Object(m.jsx)("input",{type:"text",className:"searchInput",placeholder:"Search for friend, post or video"})]})}),Object(m.jsxs)("div",{className:"topbarRight",children:[Object(m.jsxs)("div",{className:"topbarLinks",children:[Object(m.jsx)("span",{className:"topbarLink",children:"Homepage"}),Object(m.jsx)("span",{className:"topbarLink",children:"Timeline"})]}),Object(m.jsxs)("div",{className:"topbarIcons",children:[Object(m.jsxs)("div",{className:"topbarIconItem",children:[Object(m.jsx)(o.a,{}),Object(m.jsx)("span",{className:"topbarIconBadge",children:"1"})]}),Object(m.jsxs)("div",{className:"topbarIconItem",children:[Object(m.jsx)(u.b,{to:"/messenger/"+t._id,style:{textDecoration:"none",color:"white"},children:Object(m.jsx)(l.a,{})}),Object(m.jsx)("span",{className:"topbarIconBadge",children:"2"})]}),Object(m.jsxs)("div",{className:"topbarIconItem",children:[Object(m.jsx)(j.a,{}),Object(m.jsx)("span",{className:"topbarIconBadge",children:"1"})]})]}),Object(m.jsx)(u.b,{to:"/profile/".concat(t.username),children:Object(m.jsx)("img",{src:t.profilePicture?e+t.profilePicture:e+"person/noAvatar.png",alt:"",className:"topbarImg"})})]})]})}s(113);var g=s(191),N=s(192),I=s(193),w=s(194),y=s(195),k=s(196),C=s(197),L=s(198),F=[{id:1,profilePicture:"person/1.jpeg",username:"S\u01a1n T\xf9ng"},{id:2,profilePicture:"person/2.jpeg",username:"B\xf9i Anh Tu\u1ea5n"},{id:3,profilePicture:"person/3.jpeg",username:"Ly Ly"},{id:4,profilePicture:"person/4.jpeg",username:"Soobin Ho\xe0ng S\u01a1n"},{id:5,profilePicture:"person/5.jpeg",username:"Tlinh"}];s(114);function S(e){var t=e.user;return Object(m.jsxs)("li",{className:"sidebarFriend",children:[Object(m.jsx)("img",{className:"sidebarFriendImg",src:"http://localhost:8800/images/"+t.profilePicture,alt:""}),Object(m.jsx)("span",{className:"sidebarFriendName",children:t.username})]})}function _(){return Object(m.jsx)("div",{className:"sidebar",children:Object(m.jsxs)("div",{className:"sidebarwrapper",children:[Object(m.jsxs)("ul",{className:"sidebarList",children:[Object(m.jsxs)("li",{className:"sidebarListItem",children:[Object(m.jsx)(g.a,{className:"sidebarIcon"}),Object(m.jsx)("span",{className:"sidebarItemText",children:"Feed"})]}),Object(m.jsxs)("li",{className:"sidebarListItem",children:[Object(m.jsx)(l.a,{className:"sidebarIcon"}),Object(m.jsx)("span",{className:"sidebarItemText",children:"Chats"})]}),Object(m.jsxs)("li",{className:"sidebarListItem",children:[Object(m.jsx)(N.a,{className:"sidebarIcon"}),Object(m.jsx)("span",{className:"sidebarItemText",children:"Videos"})]}),Object(m.jsxs)("li",{className:"sidebarListItem",children:[Object(m.jsx)(I.a,{className:"sidebarIcon"}),Object(m.jsx)("span",{className:"sidebarItemText",children:"Groups"})]}),Object(m.jsxs)("li",{className:"sidebarListItem",children:[Object(m.jsx)(w.a,{className:"sidebarIcon"}),Object(m.jsx)("span",{className:"sidebarItemText",children:"Bookmarks"})]}),Object(m.jsxs)("li",{className:"sidebarListItem",children:[Object(m.jsx)(y.a,{className:"sidebarIcon"}),Object(m.jsx)("span",{className:"sidebarItemText",children:"Questions"})]}),Object(m.jsxs)("li",{className:"sidebarListItem",children:[Object(m.jsx)(k.a,{className:"sidebarIcon"}),Object(m.jsx)("span",{className:"sidebarItemText",children:"Jobs"})]}),Object(m.jsxs)("li",{className:"sidebarListItem",children:[Object(m.jsx)(C.a,{className:"sidebarIcon"}),Object(m.jsx)("span",{className:"sidebarItemText",children:"Events"})]}),Object(m.jsxs)("li",{className:"sidebarListItem",children:[Object(m.jsx)(L.a,{className:"sidebarIcon"}),Object(m.jsx)("span",{className:"sidebarItemText",children:"Courses"})]})]}),Object(m.jsx)("button",{className:"sidebarButton",children:"Show More"}),Object(m.jsx)("hr",{className:"sidebarHr"}),Object(m.jsx)("ul",{className:"sidebarFriendList",children:F.map((function(e){return Object(m.jsx)(S,{user:e},e.id)}))})]})})}var T=s(4),P=s.n(T),B=s(8),R=(s(116),s(199)),E=s(6),U=s.n(E),A=s(54);function D(e){var t=e.post,s=Object(a.useState)(t.likes.length),c=Object(d.a)(s,2),n=c[0],r=c[1],i=Object(a.useState)(!1),o=Object(d.a)(i,2),l=o[0],j=o[1],b=Object(a.useState)({}),p=Object(d.a)(b,2),h=p[0],O=p[1],f="http://localhost:8800/images/",v=Object(a.useContext)(x).user;Object(a.useEffect)((function(){j(t.likes.includes(v._id))}),[v._id,t.likes]),Object(a.useEffect)((function(){(function(){var e=Object(B.a)(P.a.mark((function e(){var s;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.a.get("/users?userId=".concat(t.userId));case 2:s=e.sent,O(s.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[t.userId]);var g=function(){var e=Object(B.a)(P.a.mark((function e(s){return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.preventDefault(),e.prev=1,e.next=4,U.a.delete("/posts/".concat(t._id),{userId:v._id});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.log(e.t0);case 9:console.log(t._id);case 10:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}(),N=function(){try{U.a.put("/posts/"+t._id+"/like",{userId:v._id})}catch(e){}console.log(t._id),r(l?n-1:n+1),j(!l)};return Object(m.jsx)("div",{className:"post",children:Object(m.jsxs)("div",{className:"postWrapper",children:[Object(m.jsxs)("div",{className:"postTop",children:[Object(m.jsxs)("div",{className:"postTopLeft",children:[Object(m.jsx)(u.b,{to:"profile/".concat(h.username),children:Object(m.jsx)("img",{className:"postProfileImg",src:h.profilePicture?f+h.profilePicture:f+"person/noAvatar.png",alt:""})}),Object(m.jsx)("span",{className:"postUsername",children:h.username}),Object(m.jsx)("span",{className:"postDate",children:Object(A.a)(t.createdAt)})]}),Object(m.jsxs)("div",{className:"postTopRight",children:[Object(m.jsx)("a",{href:"#",id:"navbarDropdown",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",style:{color:"black"},children:Object(m.jsx)(R.a,{className:""})}),Object(m.jsxs)("div",{class:"dropdown-menu","aria-labelledby":"navbarDropdown",children:[Object(m.jsx)("button",{class:"dropdown-item",onClick:g,children:"X\xf3a b\xe0i vi\u1ebft"}),Object(m.jsx)("button",{class:"dropdown-item",href:"#",children:"S\u1eeda b\xe0i vi\u1ebft"})]})]})]}),Object(m.jsxs)("div",{className:"postCenter",children:[Object(m.jsx)("span",{className:"postText",children:null===t||void 0===t?void 0:t.desc}),Object(m.jsx)("img",{className:"postImg",src:f+t.img,alt:""})]}),Object(m.jsxs)("div",{className:"postBottom",children:[Object(m.jsxs)("div",{className:"postBottomLeft",children:[Object(m.jsx)("img",{className:"likeIcon",src:"".concat(f,"like.png"),onClick:N,alt:""}),Object(m.jsx)("img",{className:"likeIcon",src:"".concat(f,"heart.png"),onClick:N,alt:""}),Object(m.jsxs)("span",{className:"postLikeCounter",children:[n," people liked it"]})]}),Object(m.jsx)("div",{className:"postBottomRight",children:Object(m.jsxs)("span",{className:"postCommentText",children:[t.comment," comments"]})})]})]})})}s(134);var W=s(200),M=s(201),G=s(202),V=s(203),q=s(204);function H(){var e="http://localhost:8800/images/",t=Object(a.useContext)(x).user,s=Object(a.useRef)(),c=Object(a.useState)(null),n=Object(d.a)(c,2),r=n[0],i=n[1],o=function(){var e=Object(B.a)(P.a.mark((function e(a){var c,n,i;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),c={userId:t._id,desc:s.current.value},!r){e.next=18;break}return n=new FormData,i=Date.now()+r.name,n.append("name",i),n.append("file",r),c.img=i,console.log(c),e.prev=9,e.next=12,U.a.post("/upload",n);case 12:window.location.reload(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(9),console.log(e.t0);case 18:return e.prev=18,e.next=21,U.a.post("/posts",c);case 21:e.next=25;break;case 23:e.prev=23,e.t1=e.catch(18);case 25:case"end":return e.stop()}}),e,null,[[9,15],[18,23]])})));return function(t){return e.apply(this,arguments)}}();return Object(m.jsx)("div",{className:"share",children:Object(m.jsxs)("div",{className:"shareWrapper",children:[Object(m.jsxs)("div",{className:"shareTop",children:[Object(m.jsx)("img",{className:"shareProfileImg",src:t.profilePicture?e+t.profilePicture:e+"person/noAvatar.png",alt:""}),Object(m.jsx)("input",{type:"text",className:"shareInput",placeholder:"What's in your mind "+t.username+"?",ref:s})]}),Object(m.jsx)("hr",{className:"shareHr"}),r&&Object(m.jsxs)("div",{className:"shareImgContainer",children:[Object(m.jsx)("img",{className:"shareImg",src:URL.createObjectURL(r),alt:""}),Object(m.jsx)(W.a,{className:"shareCancelImg",onClick:function(){return i(null)}})]}),Object(m.jsxs)("form",{className:"shareBottom",onSubmit:o,children:[Object(m.jsxs)("div",{className:"shareOptions",children:[Object(m.jsxs)("label",{htmlFor:"file",className:"shareOption",children:[Object(m.jsx)(M.a,{htmlColor:"tomato",className:"shareIcon"}),Object(m.jsx)("span",{className:"shareOptionText",children:"Photo or Video"}),Object(m.jsx)("input",{style:{display:"none"},type:"file",id:"file",accept:".png, .jpeg, .jpg",onChange:function(e){return i(e.target.files[0])}})]}),Object(m.jsxs)("div",{className:"shareOption",children:[Object(m.jsx)(G.a,{htmlColor:"blue",className:"shareIcon"}),Object(m.jsx)("span",{className:"shareOptionText",children:"Tag"})]}),Object(m.jsxs)("div",{className:"shareOption",children:[Object(m.jsx)(V.a,{htmlColor:"green",className:"shareIcon"}),Object(m.jsx)("span",{className:"shareOptionText",children:"Location"})]}),Object(m.jsxs)("div",{className:"shareOption",children:[Object(m.jsx)(q.a,{htmlColor:"goldenrod",className:"shareIcon"}),Object(m.jsx)("span",{className:"shareOptionText",children:"Feelings"})]})]}),Object(m.jsx)("button",{className:"shareButton",type:"submit",children:"Share"})]})]})})}s(135);function z(e){var t=e.username,s=Object(a.useState)([]),c=Object(d.a)(s,2),n=c[0],r=c[1],i=Object(a.useContext)(x).user;return Object(a.useEffect)((function(){(function(){var e=Object(B.a)(P.a.mark((function e(){var s;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return e.next=3,U.a.get("/posts/profile/"+t);case 3:e.t0=e.sent,e.next=9;break;case 6:return e.next=8,U.a.get("posts/timeline/"+i._id);case 8:e.t0=e.sent;case 9:s=e.t0,r(s.data.sort((function(e,t){return new Date(t.createdAt)-new Date(e.createdAt)})));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[t,i._id]),Object(m.jsx)("div",{className:"feed",children:Object(m.jsxs)("div",{className:"feedWrapper",children:[t===i.username&&Object(m.jsx)(H,{}),n.map((function(e){return Object(m.jsx)(D,{post:e},e._id)}))]})})}s(136),s(137);function J(e){var t=e.user;return Object(m.jsxs)("li",{className:"rightbarFriend",children:[Object(m.jsxs)("div",{className:"rightbarProfileImgContainer",children:[Object(m.jsx)("img",{className:"rightbarProfileImg",src:"http://localhost:8800/images/"+t.profilePicture,alt:""}),Object(m.jsx)("span",{className:"rightbarOnline"})]}),Object(m.jsx)("span",{className:"rightbarUsername",children:t.username})]})}var K=s(205),Q=s(206);function X(e){var t=e.user,s="http://localhost:8800/images/",c=Object(a.useState)([]),n=Object(d.a)(c,2),r=n[0],i=n[1],o=Object(a.useContext)(x),l=o.user,j=o.dispatch,b=Object(a.useState)(l.followings.includes(null===t||void 0===t?void 0:t.id)),p=Object(d.a)(b,2),h=p[0],O=p[1];Object(a.useEffect)((function(){(function(){var e=Object(B.a)(P.a.mark((function e(){var s;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,U.a.get("/users/friends/"+t._id);case 3:s=e.sent,i(s.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()()}),[t]);var f=function(){var e=Object(B.a)(P.a.mark((function e(){return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!h){e.next=7;break}return e.next=4,U.a.put("/users/"+t._id+"/unfollow",{userId:l._id});case 4:j({type:"UNFOLLOW",payload:t._id}),e.next=10;break;case 7:return e.next=9,U.a.put("/users/"+t._id+"/follow",{userId:l._id});case 9:j({type:"FOLLOW",payload:t._id});case 10:O(!h),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}(),v=function(){return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("div",{className:"birthdayContainer",children:[Object(m.jsx)("img",{className:"birthdayImg",src:"".concat(s,"gift.png"),alt:""}),Object(m.jsxs)("span",{className:"birthdayText",children:[" ",Object(m.jsx)("b",{children:"Minh Tuan"})," and ",Object(m.jsx)("b",{children:"3 other frineds"})," have a birthday today"]})]}),Object(m.jsx)("img",{className:"rightbarAd",src:"assets/ad.png",alt:""}),Object(m.jsx)("h4",{className:"rightbarTitle",children:"Online Friends"}),Object(m.jsx)("ul",{className:"rightbarFriendList",children:F.map((function(e){return Object(m.jsx)(J,{user:e},e.id)}))})]})},g=function(){return Object(m.jsxs)(m.Fragment,{children:[t.username!==l.username&&Object(m.jsxs)("button",{className:"rightbarFollowButton",onClick:f,children:[h?"Unfollow":"Follow",h?Object(m.jsx)(K.a,{}):Object(m.jsx)(Q.a,{})]}),Object(m.jsx)("h4",{className:"rightbarTitle",children:"User Infomation"}),Object(m.jsxs)("div",{className:"rightbarInfo",children:[Object(m.jsxs)("div",{className:"rightbarInfoItem",children:[Object(m.jsx)("span",{className:"rightbarInfoKey",children:"City:"}),Object(m.jsx)("span",{className:"rightbarInfoValue",children:t.city})]}),Object(m.jsxs)("div",{className:"rightbarInfoItem",children:[Object(m.jsx)("span",{className:"rightbarInfoKey",children:"From:"}),Object(m.jsx)("span",{className:"rightbarInfoValue",children:t.from})]}),Object(m.jsxs)("div",{className:"rightbarInfoItem",children:[Object(m.jsx)("span",{className:"rightbarInfoKey",children:"Relationship:"}),Object(m.jsx)("span",{className:"rightbarInfoValue",children:1===t.relationship?"Single":2===t.relationship?"Married":"-"})]}),Object(m.jsx)("h4",{className:"rightbarTitle",children:"User Friends"}),Object(m.jsx)("div",{className:"rightbarFollowings",children:r.map((function(e){return Object(m.jsx)(u.b,{to:"/profile/"+e.username,style:{textDecoration:"none",color:"black"},children:Object(m.jsxs)("div",{className:"rightbarFollowing",children:[Object(m.jsx)("img",{className:"rightbarFollowingImg",src:e.profilePicture?s+e.profilePicture:s+"person/noAvatar.png",alt:""}),Object(m.jsx)("span",{className:"rightbarFollowingName",children:e.username})]})})}))})]})]})};return Object(m.jsx)("div",{className:"rightbar",children:Object(m.jsx)("div",{className:"rightbarWrapper",children:t?Object(m.jsx)(g,{}):Object(m.jsx)(v,{})})})}s(138);function Y(){var e=Object(a.useContext)(x).user;return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(v,{}),Object(m.jsxs)("div",{className:"homeContainer",children:[Object(m.jsx)(_,{}),Object(m.jsx)(z,{username:e.username}),Object(m.jsx)(X,{})]})]})}s(139);var Z=function(){var e=Object(B.a)(P.a.mark((function e(t,s){var a;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s({type:"LOGIN_START"}),e.prev=1,e.next=4,U.a.post("auth/login",t);case 4:a=e.sent,s({type:"LOGIN_SUCCESS",payload:a.data}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),s({type:"LOGIN_FAILURE",payload:e.t0});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,s){return e.apply(this,arguments)}}(),$=s(208);function ee(){var e=Object(a.useRef)(),t=Object(a.useRef)(),s=Object(a.useContext)(x),c=s.user,n=s.isFetching,r=(s.error,s.dispatch);return console.log(c),Object(m.jsx)("div",{className:"login",children:Object(m.jsxs)("div",{className:"loginWrapper",children:[Object(m.jsxs)("div",{className:"loginLeft",children:[Object(m.jsx)("h3",{className:"loginLogo",children:"Facebook"}),Object(m.jsx)("span",{className:"loginDesc",children:"Connect with friends and the world around you on Facebook."})]}),Object(m.jsx)("div",{className:"loginRight",children:Object(m.jsxs)("form",{className:"loginBox",onSubmit:function(s){s.preventDefault(),Z({email:e.current.value,password:t.current.value},r)},children:[Object(m.jsx)("input",{placeholder:"Email",type:"email",className:"loginInput",ref:e,required:!0}),Object(m.jsx)("input",{placeholder:"Password",type:"password",className:"loginInput",ref:t,required:!0,minLength:"6"}),Object(m.jsx)("button",{className:"loginButton",type:"submit",disabled:n,children:n?Object(m.jsx)($.a,{color:"secondary",size:"20px"}):"Log In"}),Object(m.jsx)("span",{className:"loginForgot",children:"Forgot Password?"}),Object(m.jsx)("button",{className:"loginRegisterButton",children:n?Object(m.jsx)($.a,{color:"secondary",size:"20px"}):"Create a New Account"})]})})]})})}s(140);var te=s(9);function se(){var e="http://localhost:8800/images/",t=Object(a.useState)({}),s=Object(d.a)(t,2),c=s[0],n=s[1],r=Object(te.h)().username;return Object(a.useEffect)((function(){(function(){var e=Object(B.a)(P.a.mark((function e(){var t;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.a.get("/users?username=".concat(r));case 2:t=e.sent,n(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[r]),Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(v,{}),Object(m.jsxs)("div",{className:"profile",children:[Object(m.jsx)(_,{}),Object(m.jsxs)("div",{className:"profileRight",children:[Object(m.jsxs)("div",{className:"profileRightTop",children:[Object(m.jsxs)("div",{className:"profileCover",children:[Object(m.jsx)("img",{className:"profileCoverImg",src:c.coverPicture?e+c.coverPicture:e+"person/noCover.png",alt:""}),Object(m.jsx)("img",{className:"profileUserImg",src:c.profilePicture?e+c.profilePicture:e+"person/noAvatar.png",alt:""})]}),Object(m.jsxs)("div",{className:"profileInfo",children:[Object(m.jsx)("h4",{className:"profileInfoName",children:c.username}),Object(m.jsx)("span",{className:"profileInfoDesc",children:c.desc})]})]}),Object(m.jsxs)("div",{className:"profileRightBottom",children:[Object(m.jsx)(z,{username:r}),Object(m.jsx)(X,{user:c})]})]})]})]})}s(141);function ae(){var e=Object(a.useRef)(),t=Object(a.useRef)(),s=Object(a.useRef)(),c=Object(a.useRef)(),n=Object(te.g)(),r=function(){var a=Object(B.a)(P.a.mark((function a(r){var i;return P.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r.preventDefault(),c.current.value===s.current.value){a.next=5;break}s.current.setCustomValidity("Password don't match"),a.next=16;break;case 5:return i={username:e.current.value,email:t.current.value,password:s.current.value},a.prev=6,a.next=9,U.a.post("/auth/register",i);case 9:a.sent,n.push("/login"),a.next=16;break;case 13:a.prev=13,a.t0=a.catch(6),console.log(a.t0);case 16:case"end":return a.stop()}}),a,null,[[6,13]])})));return function(e){return a.apply(this,arguments)}}();return Object(m.jsx)("div",{className:"login",children:Object(m.jsxs)("div",{className:"loginWrapper",children:[Object(m.jsxs)("div",{className:"loginLeft",children:[Object(m.jsx)("h3",{className:"loginLogo",children:"Facebook"}),Object(m.jsx)("span",{className:"loginDesc",children:"Connect with friends and the world around you on Facebook."})]}),Object(m.jsx)("div",{className:"loginRight",children:Object(m.jsxs)("form",{className:"loginBox",onSubmit:r,children:[Object(m.jsx)("input",{placeholder:"Username",className:"loginInput",ref:e,required:!0}),Object(m.jsx)("input",{placeholder:"Email",className:"loginInput",ref:t,required:!0,type:"email"}),Object(m.jsx)("input",{placeholder:"Password",className:"loginInput",ref:s,required:!0,type:"password",minLength:"6"}),Object(m.jsx)("input",{placeholder:"Password Again",className:"loginInput",ref:c,required:!0,type:"password"}),Object(m.jsx)("button",{className:"loginButton",type:"submit",children:"Sign Up"}),Object(m.jsx)(u.b,{to:"/login",style:{position:"relative",right:"-90px",boxSizing:"border-box"},children:Object(m.jsx)("button",{className:"loginRegisterButton",children:"Log into Account"})})]})})]})})}s(142),s(143);function ce(e){var t=e.conversation,s=e.currentUser,c=Object(a.useState)(null),n=Object(d.a)(c,2),r=n[0],i=n[1],o="http://localhost:8800/images/";return Object(a.useEffect)((function(){var e=t.members.find((function(e){return e!==s._id}));(function(){var t=Object(B.a)(P.a.mark((function t(){var s;return P.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,U()("/users?userId="+e);case 3:s=t.sent,i(s.data),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}})()()}),[s,t]),Object(m.jsxs)("div",{className:"conversation",children:[Object(m.jsx)("img",{className:"conversationImg",src:(null===r||void 0===r?void 0:r.profilePicture)?o+r.profilePicture:o+"person/noAvatar.png",alt:""}),Object(m.jsx)("span",{className:"conversationName",children:null===r||void 0===r?void 0:r.username})]})}s(144);function ne(e){var t=e.message,s=e.own;return Object(m.jsxs)("div",{className:s?"message own":"message",children:[Object(m.jsxs)("div",{className:"messageTop",children:[Object(m.jsx)("img",{className:"messageImg",src:"https://images.pexels.com/photos/3686769/pexels-photo-3686769.jpeg?auto=compress&cs=tinysrgb&dpr=2&w=500",alt:""}),Object(m.jsx)("p",{className:"messageText",children:t.text})]}),Object(m.jsx)("div",{className:"messageBottom",children:Object(A.a)(t.createdAt)})]})}s(145);function re(e){var t=e.onlineUsers,s=e.currentId,c=e.setCurrentChat,n=Object(a.useState)([]),r=Object(d.a)(n,2),i=r[0],o=r[1],l=Object(a.useState)([]),j=Object(d.a)(l,2),u=j[0],b=j[1],p="http://localhost:8800/images/";Object(a.useEffect)((function(){(function(){var e=Object(B.a)(P.a.mark((function e(){var t;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.a.get("/users/friends/"+s);case 2:t=e.sent,o(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[s]),Object(a.useEffect)((function(){b(i.filter((function(e){return t.includes(e._id)})))}),[i,t]);var h=function(){var e=Object(B.a)(P.a.mark((function e(t){var a;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,U.a.get("/conversations/find/".concat(s,"/").concat(t._id));case 3:a=e.sent,c(a.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();return Object(m.jsx)("div",{className:"chatOnline",children:u.map((function(e){return Object(m.jsxs)("div",{className:"chatOnlineFriend",onClick:function(){return h(e)},children:[Object(m.jsxs)("div",{className:"chatOnlineImgContainer",children:[Object(m.jsx)("img",{className:"chatOnlineImg",src:(null===e||void 0===e?void 0:e.profilePicture)?p+e.profilePicture:p+"person/noAvatar.png",alt:""}),Object(m.jsx)("div",{className:"chatOnlineBadge"})]}),Object(m.jsx)("span",{className:"chatOnlineName",children:null===e||void 0===e?void 0:e.username})]})}))})}var ie=s(99);function oe(){var e=Object(a.useState)([]),t=Object(d.a)(e,2),s=t[0],c=t[1],n=Object(a.useState)(null),r=Object(d.a)(n,2),i=r[0],o=r[1],l=Object(a.useState)([]),j=Object(d.a)(l,2),u=j[0],p=j[1],h=Object(a.useState)(""),O=Object(d.a)(h,2),f=O[0],g=O[1],N=Object(a.useState)(null),I=Object(d.a)(N,2),w=I[0],y=I[1],k=Object(a.useState)([]),C=Object(d.a)(k,2),L=C[0],F=C[1],S=Object(a.useRef)(),_=Object(a.useContext)(x).user,T=Object(a.useRef)();Object(a.useEffect)((function(){S.current=Object(ie.io)("ws://localhost:8900"),S.current.on("getMessage",(function(e){y({sender:e.senderId,text:e.text,createdAt:Date.now()})}))}),[]),Object(a.useEffect)((function(){w&&(null===i||void 0===i?void 0:i.members.includes(w.sender))&&p((function(e){return[].concat(Object(b.a)(e),[w])}))}),[w,i]),Object(a.useEffect)((function(){S.current.emit("addUser",_._id),S.current.on("getUsers",(function(e){F(_.followings.filter((function(t){return e.some((function(e){return e.userId===t}))})))}))}),[_]),Object(a.useEffect)((function(){(function(){var e=Object(B.a)(P.a.mark((function e(){var t;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,U.a.get("/conversations/"+_._id);case 3:t=e.sent,c(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()()}),[_._id]),Object(a.useEffect)((function(){(function(){var e=Object(B.a)(P.a.mark((function e(){var t;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,U.a.get("/messages/"+(null===i||void 0===i?void 0:i._id));case 3:t=e.sent,p(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()()}),[i]);var R=function(){var e=Object(B.a)(P.a.mark((function e(t){var s,a,c;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),s={sender:_._id,text:f,conversationId:i._id},a=i.members.find((function(e){return e!==_._id})),S.current.emit("sendMessage",{senderId:_._id,receiverId:a,text:f}),e.prev=4,e.next=7,U.a.post("/messages",s);case 7:c=e.sent,p([].concat(Object(b.a)(u),[c.data])),g(""),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(4),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){var e;null===(e=T.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[u]),Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(v,{}),Object(m.jsxs)("div",{className:"messenger",children:[Object(m.jsx)("div",{className:"chatMenu",children:Object(m.jsxs)("div",{className:"chatMenuWrapper",children:[Object(m.jsx)("input",{placeholder:"Search for friends",className:"chatMenuInput"}),s.map((function(e){return Object(m.jsx)("div",{onClick:function(){return o(e)},children:Object(m.jsx)(ce,{conversation:e,currentUser:_})})}))]})}),Object(m.jsx)("div",{className:"chatBox",children:Object(m.jsx)("div",{className:"chatBoxWrapper",children:i?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("div",{className:"chatBoxTop",children:u.map((function(e){return Object(m.jsx)("div",{ref:T,children:Object(m.jsx)(ne,{message:e,own:e.sender===_._id})})}))}),Object(m.jsxs)("div",{className:"chatBoxBottom",children:[Object(m.jsx)("textarea",{className:"chatMessageInput",placeholder:"write something...",onChange:function(e){return g(e.target.value)},value:f}),Object(m.jsx)("button",{className:"chatSubmitButton",onClick:R,children:"Send"})]})]}):Object(m.jsx)("span",{className:"noConversationText",children:"Open a conversation to start a chat."})})}),Object(m.jsx)("div",{className:"chatOnline",children:Object(m.jsx)("div",{className:"chatOnlineWrapper",children:Object(m.jsx)(re,{onlineUsers:L,currentId:_._id,setCurrentChat:o})})})]})]})}var le=function(){var e=Object(a.useContext)(x).user;return Object(m.jsx)(u.a,{children:Object(m.jsxs)(te.d,{children:[Object(m.jsx)(te.b,{exact:!0,path:"/",children:e?Object(m.jsx)(Y,{}):Object(m.jsx)(ae,{})}),Object(m.jsx)(te.b,{path:"/login",children:e?Object(m.jsx)(te.a,{to:"/"}):Object(m.jsx)(ee,{})}),Object(m.jsx)(te.b,{path:"/register",children:e?Object(m.jsx)(te.a,{to:"/"}):Object(m.jsx)(ae,{})}),Object(m.jsx)(te.b,{path:"/profile/:username",children:Object(m.jsx)(se,{})}),Object(m.jsx)(te.b,{path:"/messenger/:userId",children:e?Object(m.jsx)(oe,{}):Object(m.jsx)(te.a,{to:"/"})})]})})};r.a.render(Object(m.jsx)(c.a.StrictMode,{children:Object(m.jsx)(f,{children:Object(m.jsx)(le,{})})}),document.getElementById("root"))}},[[176,1,2]]]);
//# sourceMappingURL=main.9d5bdb44.chunk.js.map